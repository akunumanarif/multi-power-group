input {
  beats {
    port => 5044
    host => "0.0.0.0"
  }
}

filter {
  # Grok pattern untuk parsing log
  grok {
    match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:loglevel} %{GREEDYDATA:message}" }
  }
  
  # Parse timestamp
  date {
    match => [ "timestamp", "yyyy-MM-dd HH:mm:ss.SSS" ]
    target => "@timestamp"
  }
  
  # Remove fields jika needed
  mutate {
    remove_field => [ "host" ]
  }
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    index => "filebeat-%{+YYYY.MM.dd}"
    # user => "elastic"  # jika security enabled
    # password => "password"
  }
  
  # Optional: stdout untuk debugging
  stdout {
    codec => rubydebug
  }
}